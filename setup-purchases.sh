#!/bin/bash\n\n# ğŸ›’ In-App Purchase System Setup Script\n# This script sets up the complete in-app purchase system\n\necho \"ğŸ›’ Setting up Advanced In-App Purchase System...\"\necho \"================================================\"\n\n# Colors for output\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nBLUE='\\033[0;34m'\nNC='\\033[0m' # No Color\n\n# Function to print colored output\nprint_status() {\n    echo -e \"${GREEN}âœ… $1${NC}\"\n}\n\nprint_warning() {\n    echo -e \"${YELLOW}âš ï¸ $1${NC}\"\n}\n\nprint_error() {\n    echo -e \"${RED}âŒ $1${NC}\"\n}\n\nprint_info() {\n    echo -e \"${BLUE}â„¹ï¸ $1${NC}\"\n}\n\n# Check if we're in the right directory\nif [ ! -f \"package.json\" ]; then\n    print_error \"Please run this script from the project root directory\"\n    exit 1\nfi\n\nprint_info \"Step 1: Installing Backend Dependencies\"\ncd backend\nnpm install razorpay crypto\nif [ $? -eq 0 ]; then\n    print_status \"Backend dependencies installed\"\nelse\n    print_error \"Failed to install backend dependencies\"\n    exit 1\nfi\n\nprint_info \"Step 2: Installing Frontend Dependencies\"\ncd ../frontend\nnpm install\nif [ $? -eq 0 ]; then\n    print_status \"Frontend dependencies installed\"\nelse\n    print_error \"Failed to install frontend dependencies\"\n    exit 1\nfi\n\nprint_info \"Step 3: Setting up Environment Variables\"\ncd ../backend\n\n# Check if .env exists\nif [ ! -f \".env\" ]; then\n    print_warning \".env file not found, creating from .env.example\"\n    cp .env.example .env\nfi\n\n# Add Razorpay configuration to .env if not present\nif ! grep -q \"RAZORPAY_KEY_ID\" .env; then\n    echo \"\" >> .env\n    echo \"# Razorpay Configuration\" >> .env\n    echo \"RAZORPAY_KEY_ID=your_razorpay_key_id\" >> .env\n    echo \"RAZORPAY_KEY_SECRET=your_razorpay_key_secret\" >> .env\n    print_status \"Added Razorpay configuration to .env\"\nelse\n    print_status \"Razorpay configuration already exists in .env\"\nfi\n\nprint_info \"Step 4: Setting up Frontend Environment\"\ncd ../frontend\n\n# Check if .env exists\nif [ ! -f \".env\" ]; then\n    echo \"# Razorpay Configuration\" > .env\n    echo \"VITE_RAZORPAY_KEY_ID=your_razorpay_key_id\" >> .env\n    print_status \"Created frontend .env file\"\nelse\n    if ! grep -q \"VITE_RAZORPAY_KEY_ID\" .env; then\n        echo \"VITE_RAZORPAY_KEY_ID=your_razorpay_key_id\" >> .env\n        print_status \"Added Razorpay key to frontend .env\"\n    else\n        print_status \"Frontend Razorpay configuration already exists\"\n    fi\nfi\n\nprint_info \"Step 5: Adding Razorpay Script to HTML\"\n# Add Razorpay script to index.html if not present\nif ! grep -q \"checkout.razorpay.com\" index.html; then\n    # Find the closing </head> tag and insert before it\n    sed -i.bak 's|</head>|    <script src=\"https://checkout.razorpay.com/v1/checkout.js\"></script>\\n  </head>|' index.html\n    print_status \"Added Razorpay script to index.html\"\nelse\n    print_status \"Razorpay script already exists in index.html\"\nfi\n\nprint_info \"Step 6: Seeding Database with Sample Products\"\ncd ../backend\n\n# Check if MongoDB is running\nprint_info \"Checking MongoDB connection...\"\nnode -e \"import('./src/lib/db.js').then(({connectDB}) => connectDB()).then(() => {console.log('MongoDB connected'); process.exit(0);}).catch(err => {console.error('MongoDB connection failed:', err.message); process.exit(1);})\" 2>/dev/null\n\nif [ $? -eq 0 ]; then\n    print_status \"MongoDB is connected\"\n    print_info \"Seeding products...\"\n    node src/scripts/seedProducts.js\n    if [ $? -eq 0 ]; then\n        print_status \"Database seeded with sample products\"\n    else\n        print_warning \"Failed to seed database - you can run this manually later\"\n    fi\nelse\n    print_warning \"MongoDB not connected - skipping database seeding\"\n    print_info \"You can seed the database later by running: node src/scripts/seedProducts.js\"\nfi\n\nprint_info \"Step 7: Creating Quick Start Guide\"\ncd ..\ncat > PURCHASE_QUICK_START.md << 'EOF'\n# ğŸš€ Quick Start Guide - In-App Purchases\n\n## ğŸ”§ Setup Checklist\n\n### 1. Razorpay Account Setup\n- [ ] Create Razorpay account at https://razorpay.com\n- [ ] Get API keys from Dashboard > Settings > API Keys\n- [ ] Replace `your_razorpay_key_id` in both .env files\n- [ ] Replace `your_razorpay_key_secret` in backend .env\n\n### 2. Test the System\n- [ ] Start backend: `cd backend && npm run dev`\n- [ ] Start frontend: `cd frontend && npm run dev`\n- [ ] Visit store at: http://localhost:5173/store\n- [ ] Test purchase flow with Razorpay test mode\n\n### 3. Go Live\n- [ ] Switch Razorpay to live mode\n- [ ] Update API keys with live credentials\n- [ ] Test with real payments (small amounts)\n- [ ] Monitor transactions in Razorpay dashboard\n\n## ğŸ’° Revenue Expectations\n\n### Month 1: â‚¹10,000 - â‚¹25,000\n- Focus on user adoption\n- Run launch promotions\n- Gather user feedback\n\n### Month 3: â‚¹50,000 - â‚¹1,00,000\n- Optimize based on data\n- Add more products\n- Implement referral system\n\n### Month 6: â‚¹2,00,000 - â‚¹5,00,000\n- Scale marketing efforts\n- Launch premium subscriptions\n- Partner with influencers\n\n## ğŸ¯ Success Tips\n\n1. **Start Small**: Launch with core products first\n2. **Listen to Users**: Implement requested features\n3. **A/B Test**: Optimize pricing and UI continuously\n4. **Seasonal Sales**: Run special promotions\n5. **Quality First**: Ensure smooth purchase experience\n\n## ğŸ†˜ Support\n\nIf you need help:\n1. Check the main documentation: `IN_APP_PURCHASES_GUIDE.md`\n2. Review Razorpay documentation\n3. Test in sandbox mode first\n4. Monitor server logs for errors\n\n**ğŸš€ You're ready to start earning! Good luck!**\nEOF\n\nprint_status \"Created quick start guide\"\n\necho \"\"\necho \"ğŸ‰ Setup Complete!\"\necho \"==================\"\nprint_status \"âœ… Backend dependencies installed\"\nprint_status \"âœ… Frontend dependencies installed\"\nprint_status \"âœ… Environment files configured\"\nprint_status \"âœ… Razorpay script added to HTML\"\nprint_status \"âœ… Database seeded (if MongoDB was connected)\"\nprint_status \"âœ… Quick start guide created\"\n\necho \"\"\nprint_info \"ğŸ“‹ Next Steps:\"\necho \"1. ğŸ”‘ Get Razorpay API keys from https://razorpay.com\"\necho \"2. ğŸ“ Update .env files with your actual Razorpay keys\"\necho \"3. ğŸš€ Start the servers:\"\necho \"   Backend: cd backend && npm run dev\"\necho \"   Frontend: cd frontend && npm run dev\"\necho \"4. ğŸ›’ Visit http://localhost:5173/store to test\"\necho \"5. ğŸ“– Read PURCHASE_QUICK_START.md for detailed instructions\"\n\necho \"\"\nprint_info \"ğŸ’° Revenue Potential:\"\necho \"   Month 1: â‚¹10,000 - â‚¹25,000\"\necho \"   Month 3: â‚¹50,000 - â‚¹1,00,000\"\necho \"   Month 6: â‚¹2,00,000 - â‚¹5,00,000\"\n\necho \"\"\nprint_status \"ğŸ¯ Your advanced in-app purchase system is ready!\"\nprint_info \"Happy monetizing! ğŸ’°ğŸš€\"